{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst api = '54028889-2cc77c36b1263169d392db777';\n\nconst getImagesByQuery = async (query, page) => {\n  const queryResult = await axios({\n    method: 'get',\n    baseURL: 'https://pixabay.com/',\n    url: 'api/',\n    params: {\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      key: api,\n      q: query,\n      per_page: 15,\n      page: page,\n    },\n  });\n\n  return queryResult.data;\n};\n\nexport default getImagesByQuery;\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'title',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\nconst galleryList = document.querySelector('.gallery');\n\nexport const createGallery = images => {\n  const galleryMarkup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n            src=\"${webformatURL}\" \n            alt=\"${tags}\"\n            title=\"${tags}\"\n            class=\"gallery-img\">\n        </a>\n            <div class=\"stats\">\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Likes</span>\n              <p class=\"bottom-txt\">${likes}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Views</span>\n              <p class=\"bottom-txt\">${views}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Comments</span>\n              <p class=\"bottom-txt\">${comments}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Downloads</span>\n              <p class=\"bottom-txt\">${downloads}</p>\n            </div>\n          </div>\n        </li>`;\n      }\n    )\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  modal.refresh();\n};\n\nexport const clearGallery = () => {\n  galleryList.innerHTML = '';\n\n  modal.refresh();\n};\n\nconst loader = document.querySelector('.loader');\nexport const showLoader = () => {\n  loader.style.display = 'inline-block';\n};\n\nexport const hideLoader = () => {\n  loader.style.display = 'none';\n};\n\nconst loadMoreBtn = document.querySelector('.js-more-btn');\nexport const showLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'inline-block';\n};\n\nexport const hideLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'none';\n};\n","import getImagesByQuery from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\nhideLoader();\n\nlet page = 1;\nlet searchQuery = null;\n\nconst loadMoreBtn = document.querySelector('.js-more-btn');\nconst loadMoreHandler = async evt => {\n  page += 1;\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const posts = await getImagesByQuery(searchQuery, page);\n    createGallery(posts.hits);\n\n    const galleryItm = document.querySelector('.gallery-item');\n\n    if (galleryItm) {\n      const rect = galleryItm.getBoundingClientRect();\n      const itmHeight = rect.height;\n      window.scrollBy({\n        top: itmHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    const totalPages = page * 15;\n\n    if (totalPages >= posts.totalHits) {\n      iziToast.info({\n        title: 'Error',\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch {\n    iziToast.error({ message: 'Server error or connection lost' });\n  } finally {\n    hideLoader();\n  }\n};\n\nconst submitHandler = async evt => {\n  evt.preventDefault();\n\n  let userRequest = document.querySelector('.js-search-field').value.trim();\n  if (userRequest === '') {\n    form.reset();\n    return;\n  }\n\n  searchQuery = userRequest;\n\n  clearGallery();\n  hideLoadMoreButton();\n\n  page = 1;\n  showLoader();\n\n  try {\n    const queryResult = await getImagesByQuery(searchQuery, page);\n\n    if (queryResult.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n    createGallery(queryResult.hits);\n\n    if (queryResult.totalHits > 15) {\n      showLoadMoreButton();\n    }\n  } catch {\n    iziToast.error({ message: 'Server error or connection lost' });\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n};\n\nform.addEventListener('submit', submitHandler);\nloadMoreBtn.addEventListener('click', loadMoreHandler);\n"],"names":["api","getImagesByQuery","query","page","axios","modal","SimpleLightbox","galleryList","createGallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","loader","showLoader","hideLoader","loadMoreBtn","showLoadMoreButton","hideLoadMoreButton","form","searchQuery","loadMoreHandler","evt","posts","galleryItm","itmHeight","iziToast","submitHandler","userRequest","queryResult"],"mappings":"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"}