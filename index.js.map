{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst api = '54028889-2cc77c36b1263169d392db777';\n\nconst getImagesByQuery = async (query, page) => {\n  const queryResult = await axios({\n    method: 'get',\n    baseURL: 'https://pixabay.com/',\n    url: 'api/',\n    params: {\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      key: api,\n      q: query,\n      per_page: 15,\n      page: page,\n    },\n  });\n\n  return queryResult.data;\n};\n\nexport default getImagesByQuery;\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'title',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\nconst galleryList = document.querySelector('.gallery');\n\nexport const createGallery = images => {\n  const galleryMarkup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n            src=\"${webformatURL}\" \n            alt=\"${tags}\"\n            title=\"${tags}\"\n            class=\"gallery-img\">\n        </a>\n            <div class=\"stats\">\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Likes</span>\n              <p class=\"bottom-txt\">${likes}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Views</span>\n              <p class=\"bottom-txt\">${views}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Comments</span>\n              <p class=\"bottom-txt\">${comments}</p>\n            </div>\n            <div class=\"stats-item\">\n              <span class=\"top-txt\">Downloads</span>\n              <p class=\"bottom-txt\">${downloads}</p>\n            </div>\n          </div>\n        </li>`;\n      }\n    )\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', galleryMarkup);\n\n  modal.refresh();\n};\n\nexport const clearGallery = () => {\n  galleryList.innerHTML = '';\n\n  modal.refresh();\n};\n\nconst loader = document.querySelector('.loader');\nexport const showLoader = () => {\n  loader.style.display = 'inline-block';\n};\n\nexport const hideLoader = () => {\n  loader.style.display = 'none';\n};\n\nconst loadMoreBtn = document.querySelector('.js-more-btn');\nexport const showLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'inline-block';\n};\n\nexport const hideLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'none';\n};\n","import getImagesByQuery from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\nhideLoader();\n\nlet page = 1;\nlet searchQuery = null;\n\nconst loadMoreBtn = document.querySelector('.js-more-btn');\nconst loadMoreHandler = async evt => {\n  page += 1;\n  showLoader();\n\n  try {\n    const posts = await getImagesByQuery(searchQuery, page);\n    createGallery(posts.hits);\n\n    const galleryItm = document.querySelector('.gallery-item');\n\n    const rect = galleryItm.getBoundingClientRect();\n    const itmHeight = rect.height;\n    window.scrollBy({\n      top: itmHeight * 2,\n      behavior: 'smooth',\n    });\n\n    const totalPages = page * 15;\n    if (totalPages >= posts.totalHits) {\n      throw new Error('');\n    }\n  } catch {\n    iziToast.error({\n      title: 'Error',\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n  }\n};\n\nconst submitHandler = evt => {\n  evt.preventDefault();\n\n  let userRequest = document.querySelector('.js-search-field').value.trim();\n  if (userRequest === '') {\n    form.reset();\n    return;\n  }\n\n  searchQuery = userRequest;\n\n  clearGallery();\n  page = 1;\n  showLoader();\n\n  getImagesByQuery(searchQuery, page)\n    .then(data => {\n      if (data.hits.length === 0) {\n        iziToast.error({\n          title: 'Error',\n          position: 'topRight',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        return;\n      }\n      createGallery(data.hits);\n      showLoadMoreButton();\n    })\n    .catch(err => {\n      iziToast.error({ message: 'Server error or connection lost' });\n    })\n    .finally(() => {\n      hideLoader();\n      form.reset();\n    });\n};\n\nform.addEventListener('submit', submitHandler);\nloadMoreBtn.addEventListener('click', loadMoreHandler);\n"],"names":["api","getImagesByQuery","query","page","axios","modal","SimpleLightbox","galleryList","createGallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","loader","showLoader","hideLoader","loadMoreBtn","showLoadMoreButton","hideLoadMoreButton","form","searchQuery","loadMoreHandler","evt","posts","itmHeight","iziToast","submitHandler","userRequest","data","err"],"mappings":"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"}